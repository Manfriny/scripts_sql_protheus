SELECT * FROM  NJM010 WHERE NJM_FILIAL='0301' AND NJM_CODctr in ('000930','000954','000864','000892') ;--ITENS DO ROMANEIOS VINCULADOS AOS CONTRATOS

SELECT DISTINCT NJM_DOCNUM FROM  NJM010 WHERE NJM_FILIAL='0301' AND NJM_CODctr in ('000930','000954','000864','000892') AND NJM_DOCNUM<> ' ' AND D_E_L_E_T_=' ';--LISTA AS NF QUE SÃO REFERENTES AOS CONTRATOS

--VERIFICO REGISTROS NA SD1 QUE ESTÃO SEM AS INFORMAÇÕES
select D1_DOC,D1_SERIE,D1_CTROG,D1_CODROM,D1_ITEROM from sd1010 where d1_filial='0301' 
and d1_doc in (SELECT DISTINCT NJM_DOCNUM FROM  NJM010 WHERE NJM_FILIAL='0301' AND NJM_CODctr in ('000853','000930','000954','000864','000892','000891','000893') AND NJM_DOCNUM<> ' ' AND D_E_L_E_T_=' ') and D_E_L_E_T_=' ';

---AJUSTAR SD1 SEM DADOS DO ROMANEIO E CONTRATO

UPDATE SD1010 SET
D1_CTROG=NVL((SELECT NJM_CODCTR FROM  NJM010 WHERE NJM_FILIAL=D1_FILIAL AND NJM_DOCNUM=D1_DOC AND NJM_DOCSER=D1_SERIE and D_E_L_E_T_=' '),' '),
D1_CODROM=NVL((SELECT NJM_CODROM FROM  NJM010 WHERE NJM_FILIAL=D1_FILIAL AND NJM_DOCNUM=D1_DOC AND NJM_DOCSER=D1_SERIE and D_E_L_E_T_=' '),' '),
D1_ITEROM=NVL((SELECT NJM_ITEROM FROM  NJM010 WHERE NJM_FILIAL=D1_FILIAL AND NJM_DOCNUM=D1_DOC AND NJM_DOCSER=D1_SERIE and D_E_L_E_T_=' '),' ')
WHERE 
d1_filial='0301' and d1_doc in (SELECT DISTINCT NJM_DOCNUM FROM  NJM010 WHERE NJM_FILIAL='0301' AND NJM_CODctr in ('000893') AND NJM_DOCNUM<> ' ' AND D_E_L_E_T_=' ') 
and(D1_CTROG=' ' or D1_CODROM=' ' or D1_ITEROM=' ') and D_E_L_E_T_=' ';